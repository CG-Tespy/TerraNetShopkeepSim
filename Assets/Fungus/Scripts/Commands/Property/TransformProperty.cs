/*This script has been, partially or completely, generated by the Fungus.GenerateVariableWindow*/

ï»¿// This code is part of the Fungus library (https://github.com/snozbot/fungus)
// It is released for free under the MIT open source license (https://github.com/snozbot/fungus/blob/master/LICENSE)

using System.Collections;
using System.Collections.Generic;
using UnityEngine;

namespace Fungus
{
    // <summary>
    /// Get or Set a property of a Transform component
    /// </summary>
    [CommandInfo("Property",
                 "Transform",
                 "Get or Set a property of a Transform component")]
    [AddComponentMenu("")]
    public class TransformProperty : BaseVariableProperty
    {
		//generated property
        public enum Property 
        { 
            ChildCount, 
            EulerAngles, 
            Forward, 
            HasChanged, 
            HierarchyCapacity, 
            HierarchyCount, 
            LocalEulerAngles, 
            LocalPosition, 
            LocalScale, 
            LossyScale, 
            Parent, 
            Position, 
            Right, 
            Root, 
            Up, 
            Rotation, 
            LocalRotation, 
            WorldToLocalMatrix, 
            LocalToWorldMatrix, 

            SiblingIndex,
        }

		
        [SerializeField]
        protected Property property = Property.Position;

        [SerializeField]
        protected TransformData transformData;

        [SerializeField]
        [VariableProperty(typeof(Vector3Variable),
                          typeof(QuaternionVariable),
                          typeof(TransformVariable),
                          typeof(Matrix4x4Variable),
                          typeof(IntegerVariable),
                          typeof(BooleanVariable))]
        protected Variable inOutVar;

        public override void OnEnter()
        {
            var inOutVec3 = inOutVar as Vector3Variable;
            var inOutQuaternion = inOutVar as QuaternionVariable;
            var inOutTransform = inOutVar as TransformVariable;
            var inOutMatrix4 = inOutVar as Matrix4x4Variable;
            var inOutInteger = inOutVar as IntegerVariable;
            var inOutBoolean = inOutVar as BooleanVariable;

            var target = transformData.Value;

            switch (getOrSet)
            {
                case GetSet.Get:
                    switch (property)
                    {
                        case Property.Position:
                            inOutVec3.Value = target.position;
                            break;
                        case Property.LocalPosition:
                            inOutVec3.Value = target.localPosition;
                            break;
                        case Property.EulerAngles:
                            inOutVec3.Value = target.eulerAngles;
                            break;
                        case Property.LocalEulerAngles:
                            inOutVec3.Value = target.localEulerAngles;
                            break;
                        case Property.Right:
                            inOutVec3.Value = target.right;
                            break;
                        case Property.Up:
                            inOutVec3.Value = target.up;
                            break;
                        case Property.Forward:
                            inOutVec3.Value = target.forward;
                            break;
                        case Property.Rotation:
                            inOutQuaternion.Value = target.rotation;
                            break;
                        case Property.LocalRotation:
                            inOutQuaternion.Value = target.localRotation;
                            break;
                        case Property.LocalScale:
                            inOutVec3.Value = target.localScale;
                            break;
                        case Property.Parent:
                            inOutTransform.Value = target.parent;
                            break;
                        case Property.WorldToLocalMatrix:
                            inOutMatrix4.Value = target.worldToLocalMatrix;
                            break;
                        case Property.LocalToWorldMatrix:
                            inOutMatrix4.Value = target.localToWorldMatrix;
                            break;
                        case Property.Root:
                            inOutTransform.Value = target.root;
                            break;
                        case Property.ChildCount:
                            inOutInteger.Value = target.childCount;
                            break;
                        case Property.LossyScale:
                            inOutVec3.Value = target.lossyScale;
                            break;
                        case Property.HasChanged:
                            inOutBoolean.Value = target.hasChanged;
                            break;
                        case Property.HierarchyCapacity:
                            inOutInteger.Value = target.hierarchyCapacity;
                            break;
                        case Property.HierarchyCount:
                            inOutInteger.Value = target.hierarchyCount;
                            break;

                        case Property.SiblingIndex:
                            inOutInteger.Value = target.GetSiblingIndex();
                            break;

                        default:
                            Debug.Log("Unsupported get or set attempted");
                            break;
                    }
                    break;
                case GetSet.Set:
                    switch (property)
                    {
                        case Property.Position:
                            target.position = inOutVec3.Value;
                            break;
                        case Property.LocalPosition:
                            target.localPosition = inOutVec3.Value;
                            break;
                        case Property.EulerAngles:
                            target.eulerAngles = inOutVec3.Value;
                            break;
                        case Property.LocalEulerAngles:
                            target.localEulerAngles = inOutVec3.Value;
                            break;
                        case Property.Right:
                            target.right = inOutVec3.Value;
                            break;
                        case Property.Up:
                            target.up = inOutVec3.Value;
                            break;
                        case Property.Forward:
                            target.forward = inOutVec3.Value;
                            break;
                        case Property.Rotation:
                            target.rotation = inOutQuaternion.Value;
                            break;
                        case Property.LocalRotation:
                            target.localRotation = inOutQuaternion.Value;
                            break;
                        case Property.LocalScale:
                            target.localScale = inOutVec3.Value;
                            break;
                        case Property.Parent:
                            target.SetParent(inOutTransform.Value, true);
                            break;
                        case Property.HasChanged:
                            target.hasChanged = inOutBoolean.Value;
                            break;
                        case Property.HierarchyCapacity:
                            target.hierarchyCapacity = inOutInteger.Value;
                            break;

                        case Property.SiblingIndex:
                            target.SetSiblingIndex(inOutInteger.Value);
                            break;

                        default:
                            Debug.Log("Unsupported get or set attempted");
                            break;
                    }
                    break;
                default:
                    break;
            }

            Continue();
        }

        public override string GetSummary()
        {
            if (transformData.Value == null)
            {
                return "Error: no transform set";
            }
            if (inOutVar == null)
            {
                return "Error: no variable set to push or pull data to or from";
            }

            //We could do further checks here, eg, you have selected childcount but set a vec3variable

            return getOrSet.ToString() + " " + property.ToString();
        }

        public override Color GetButtonColor()
        {
            return new Color32(235, 191, 217, 255);
        }

        public override bool HasReference(Variable variable)
        {
            if (transformData.transformRef == variable || inOutVar == variable)
                return true;

            return false;
        }

    }
}